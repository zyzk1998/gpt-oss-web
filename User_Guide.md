

# 📘 GIBH Qwen Galaxy 用户使用指南

## 🚀 核心能力速览
1.  **全能单模态**：一个模型搞定对话、代码生成和**图片识别**（报错截图/生信图表）。
2.  **意图优先**：先规划流程，再检查数据，不卡壳。
3.  **自动驾驶**：支持用自然语言直接触发后台任务，自动填参，自动轮询进度。
4.  **记忆增强**：能记住上一轮对话的上下文（如“使用历史数据”）。

---

## 🗣️ 常用指令清单 (Cheat Sheet)

这是最核心的部分，忘记怎么问的时候看这里：

### 1. 启动与规划 (Planning)
*   **标准起手式**：
    > “我要做单细胞转录组测序全流程分析，请进行规划。”
*   **查看步骤**：
    > “列出 Seurat 标准工作流的步骤。”
    > “我想看看单细胞分析有哪些环节。”

### 2. 数据准备 (Data)
*   **查看历史数据**（触发数据选择器）：
    > “看看我 Galaxy 历史记录里有哪些文件？”
    > “我要从历史记录里选文件。”
*   **指定文件**（自然语言解析）：
    > “使用 5, 6, 7 号文件进行分析。”
    > “基于 matrix.mtx 和 barcodes.tsv 进行规划。”

### 3. 执行任务 (Execution)
*   **一键执行**（最高效）：
    > “已选择文件，请执行 Seurat 全流程。”
    > “基于我上传的三个文件，直接运行单细胞标准流程。”
*   **分步/跳步执行**：
    *   *先规划，在弹出的卡片中取消勾选不需要的步骤，然后点“执行”。*
    *   *或者说：* “跳过第一步创建对象，直接从第二步过滤开始跑。”（需确保有 RDS 文件）

### 4. 咨询与查询 (Consultation)
*   **查工具**：
    > “列出 Galaxy 中所有 Seurat 相关的工具。”
    > “帮我找一下去批次效应的工具。”

### 5. 视觉分析 (Vision - Qwen3-VL 独占)
*   **直接拖入图片**，然后问：
    > “帮我分析这张报错截图，告诉我怎么修。”
    > “解读一下这张 UMAP 图的生物学意义。”

---

## 🛠️ 典型操作流程 (Best Practice)

### 场景一：从零开始的标准分析
1.  **上传数据**：直接拖拽 `matrix.mtx`, `genes.tsv`, `barcodes.tsv` 到聊天框上传。
2.  **下达指令**：
    *   *用户*：“我要做单细胞分析，请规划工作流。”
3.  **确认步骤**：
    *   *智能体*：（弹出工作流卡片，预填最佳参数）
4.  **执行**：
    *   点击卡片下方的 **🚀 执行工作流** 按钮。
    *   *或者输入*：“确认执行。”
5.  **监控**：
    *   *智能体*：（弹出垂直进度条，实时显示 Step 1... Step 2...）

### 场景二：复用历史数据 + 自然语言直达
1.  **下达指令**：
    *   *用户*：“我要用历史数据跑 Seurat 流程。”
2.  **选择数据**：
    *   *智能体*：（弹出带滚动条的数据选择器）
    *   *用户*：（勾选文件 -> 点击“确认使用”）
3.  **自动接力**：
    *   *智能体*：“已选择文件... 正在启动后台任务...”
    *   （无需再次确认，直接进入进度条监控模式）

### 场景三：中途上车 (跳过前几步)
1.  **前提**：你已经在 Galaxy 里跑过前几步，有一个 `.rds` 文件在历史记录里。
2.  **下达指令**：
    *   *用户*：“我要做单细胞分析，规划工作流。”
3.  **调整规划**：
    *   在弹出的卡片中，**取消勾选** “1. 创建对象”。
    *   点击 **执行**。
4.  **数据检查**：
    *   如果没选文件，智能体会提示你选。
    *   *用户*：（在选择器里勾选那个 `.rds` 文件）
5.  **后台运行**：
    *   后端会自动识别这是 RDS 文件，并将其作为第二步（Filter）的输入。

---

## ⚠️ 避坑指南

1.  **关于文件名**：
    *   虽然智能体很聪明，但为了提高成功率，上传的文件名最好包含标准关键词：`matrix`, `genes` (或 `features`), `barcodes`。
    *   如果是中间文件，后缀最好是 `.rds`。

2.  **关于参数修改**：
    *   智能体预填的参数（如 `min.cells=3`）是生信界的“万金油”参数。
    *   如果你不是非常确定，**尽量不要手动去改卡片里的参数**，否则容易因为 Galaxy 的格式校验（如不能有下划线）导致 400 错误。

3.  **关于等待**：
    *   进度条是每隔几秒轮询一次的。如果看到 `pending` 变成了 `running`，说明任务已经提交给 Galaxy 了。
    *   如果长时间卡在 `running`，那是 Galaxy 服务器慢，不是智能体卡了，请耐心等待或去 Galaxy 网页端查看。

---

**记住一句话心法：**
> **“先说意图（我要做什么），再选数据（用什么做），最后看进度（做得怎么样）。”**
